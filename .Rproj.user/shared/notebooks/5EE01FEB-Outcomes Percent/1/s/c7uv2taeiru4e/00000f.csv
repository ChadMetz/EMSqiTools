"0","query <- """
"0","SELECT"
"0","    [Incident_Patient_Care_Report_Number] AS 'PCR Number',"
"0","    [Response_EMS_Response_Number] AS 'Incident Number',"
"0","    FORMAT([Dim_Incident].[Incident_Unit_Notified_By_Dispatch_Date_Time], 'MM-dd-yyyy') AS 'Call Date',"
"0","    YEAR([Incident_Unit_Notified_By_Dispatch_Date_Time]) AS 'Year',"
"0","    MONTH([Incident_Unit_Notified_By_Dispatch_Date_Time]) AS 'Month',"
"0","    CASE "
"0","        WHEN MONTH([Incident_Unit_Notified_By_Dispatch_Date_Time]) IN (1, 2, 3) THEN 1"
"0","        WHEN MONTH([Incident_Unit_Notified_By_Dispatch_Date_Time]) IN (4, 5, 6) THEN 2"
"0","        WHEN MONTH([Incident_Unit_Notified_By_Dispatch_Date_Time]) IN (7, 8, 9) THEN 3"
"0","        WHEN MONTH([Incident_Unit_Notified_By_Dispatch_Date_Time]) IN (10, 11, 12) THEN 4"
"0","    END AS 'Quarter',"
"0","    DATEPART(WEEK, [Incident_Unit_Notified_By_Dispatch_Date_Time]) AS 'Week_of_Year',"
"0","    DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) AS TimeDifferenceInMinutes,"
"0","    CASE "
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 60 THEN 'Under 1 hour'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 120 THEN 'Under 2 hours'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 240 THEN 'Under 4 hours'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 360 THEN 'Under 6 hours'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 480 THEN 'Under 8 hours'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 600 THEN 'Under 10 hours'"
"0","    WHEN DATEDIFF(MINUTE, [Incident_Unit_Back_In_Service_Date_Time], [Incident_Marked_As_Finished_Date_Time]) < 720 THEN 'Under 12 hours'"
"0","    ELSE '12 hours or more'"
"0","END AS TimeToFinishCategory"
"0","FROM [Imagetrend].[DwEms].[Fact_Incident]"
"0","LEFT JOIN [Imagetrend].[DwEms].[Dim_Incident] ON [Fact_Incident].[Dim_Incident_FK] = [Dim_Incident].[Dim_Incident_PK]"
"0","LEFT JOIN [Imagetrend].[DwEms].[Dim_Response] ON [Fact_Incident].[Dim_Response_FK] = [Dim_Response].[Dim_Response_PK]"
"0","LEFT JOIN [Imagetrend].[DwEms].[Dim_Situation] ON [Fact_Incident].[Dim_Situation_FK] = [Dim_Situation].[Dim_Situation_PK]"
"0","LEFT JOIN [Imagetrend].[DwEms].[Dim_Patient] ON [Fact_Incident].[Dim_Patient_FK] = [Dim_Patient].[Dim_Patient_PK]"
"0","LEFT JOIN [Imagetrend].[DwEms].[Dim_Incident_One_To_One]  ON [Fact_Incident].[Dim_Incident_One_To_One_PK] = [Dim_Incident_One_To_One].[Dim_Incident_One_To_One_PK]"
"0","WHERE [Response_EMS_Agency_Number] = '183032'"
"0","AND [Incident_Unit_Notified_By_Dispatch_Date_Time] > '2024-09-04 07:30:00';"
"0",""""
"0",""
"0","df2 <- dbGetQuery(con, query)"
"0","View(df2)"
